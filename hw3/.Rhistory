res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(20, mean = 0, sd = 200)
res3 <- perm_test_mean(tr_3, ctrl_3)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3000, mean = 1, sd = 1)
ctrl_3 <- rnorm(200, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3000, mean = 1, sd = 1)
ctrl_3 <- rnorm(200, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3000, mean = .01, sd = 1)
ctrl_3 <- rnorm(200, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(100, mean = .01, sd = 1)
ctrl_3 <- rnorm(2000, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
rr <- perm_test_mean((-1.2,0,1.1), c(-2000, -1000, 1000, 2000), iters = 10000)
rr <- perm_test_mean(c(-1.2,0,1.1), c(-2000, -1000, 1000, 2000), iters = 10000)
rr <- perm_test_mean(c(-1.2,0,1.1), c(-2000, -1000, 1000, 2000), iters = 10000)
rr3$MeansPvalue[3] - rr3$tPvalue[3]
rr$MeansPvalue[3] - rr$tPvalue[3]
rr
rr <- perm_test_mean(c(-1.2,0,1.1), c(-2000, -1500, 1000, 2500), iters = 10000)
rr$MeansPvalue[3] - rr$tPvalue[3]
rr
rr$TestStats
tr_3 <- rnorm(1000, mean = 1, sd = 1)
ctrl_3 <- rnorm(2000, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(1000, mean = 1, sd = 1)
ctrl_3 <- rnorm(2000, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$TestStats
res3$MeansPvalue[3] - res3$tPvalue[3]
res3
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(2000, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4, mean = 0, sd = 1)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(40, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(400, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(300, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3000, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(40000, mean = 0, sd = 1000)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.9, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 5)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 5)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 5)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 5)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 5)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 1, sd = 1)
ctrl_3 <- rnorm(4000, mean = 0.99, sd = 5)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 10)
ctrl_3 <- rnorm(4000, mean = 10, sd = 10)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 10)
ctrl_3 <- rnorm(4000, mean = 10, sd = 10)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 10)
ctrl_3 <- rnorm(4000, mean = 1, sd = 10)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 10)
ctrl_3 <- rnorm(4000, mean = 1, sd = 10)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(4000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(4000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(4000, mean = .5, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
rr <- perm_test_mean(c(-1.2,0,1.1), c(-2000, -1500, 1000, 2500), iters = 10000)
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(4000, mean = .5, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(4000, mean = .1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(4000, mean = .7, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = .7, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(1000, mean = .7, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(3, mean = 0, sd = 1)
ctrl_3 <- rnorm(1000, mean = .7, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(1000, mean = 0, sd = 1)
ctrl_3 <- rnorm(1000, mean = .7, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 50000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3
res3$MeansPvalue[3] - res3$tPvalue[3]
mean(tr_3)
mean(ctrl_3)
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 100)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 10)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 10)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 10)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 1000)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 1000)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 1000)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 1000)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
p.df <- rep(NA, 1000)
for(i in 1:1000){
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
p.df[i] <- res3$MeansPvalue[3] - res3$tPvalue[3]
}
sum(!is.na(p.df))
library(ggplot2)
ggplot(data.frame(x=p.df)) + geom_histogram(aes(x=x))
ggplot(data.frame(x=p.df)) + geom_histogram(aes(x=x), binwidth=.1)
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3$TestStats
res3$tPvalue
res3$MeansPvalue
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(10000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] - res3$tPvalue[3]
res3$TestStats
res3$tPvalue
res3$MeansPvalue
set.seed(50)
compute_test_stats <- function(x, y){
# Computes difference in means and t statistic for tr. group x and control group y
n <- length(x); m <- length(y);
diff_means <- mean(x) - mean(y)
# Do we need to multiply variance by n-1/n and m-1/m?
# Andrew - I don't think so, we are estimating the variance
#   in a t-test
t <- diff_means/sqrt(var(x)/n + var(y)/m)
return(c("diff_means" = diff_means, "t" = t))
}
perm_test_mean <- function(x, y, iters = 10000){
# Performs permutation tests on the difference of means
#   and the t-statistic
# Input:
#   x - vector of observations for treatment group
#   y - vector of observations for control group
#   iters - number of permutations
# Output:
#   TestStats - vector containing difference in means and the t-statistic
#   Pvalue - vector with lower, upper, and two-tailed p-values
n <- length(x)
box <- c(x, y)
obs <- compute_test_stats(x, y)
distr <- replicate(iters, {
shuffle <- sample(box)
xnew <- shuffle[1:n]
ynew <- shuffle[-(1:n)]
compute_test_stats(xnew, ynew)
})
pval_diffmeans <- c("upper" = sum(distr[1,] >= obs[1])/iters,
"lower" = sum(distr[1,] <= obs[1])/iters,
"both" = sum(abs(distr[1,]) >= abs(obs[1]))/iters)
pval_t <- c("upper" = sum(distr[2,] >= obs[2])/iters,
"lower" = sum(distr[2,] <= obs[2])/iters,
"both" = sum(abs(distr[2,]) >= abs(obs[2]))/iters)
return(list("TestStats" = obs,
"distr" = distr,
"MeansPvalue" = pval_diffmeans,
"tPvalue" = pval_t))
}
### Problem 2: Construct a hypothetical dataset
# (with at least 3 data points in treatment and at least 3 in control)
# for which the p-value of a permutation test based on X Ì is smaller
# than the p-value of a permutation test based on t.
tr <- rnorm(5, mean = 0, sd = 20)
# [1]  10.9933979 -16.8320749   0.6599587  10.4829942 -34.5520822
ctrl <- rnorm(100, mean = 0, sd = 1)
res2 <- perm_test_mean(tr, ctrl)
res2$MeansPvalue
#upper lower  both
#0.95  0.05  0.05
#
res2$tPvalue
#upper lower  both
#0.861 0.139 0.559
res2$TestStats
#diff_means          t
#-5.7512729 -0.6559599
### Problem 3: Construct a hypothetical dataset
# (with at least 3 data points in treatment and at least 3 in control)
# for which the p-value of a permutation test based on t is smaller than
# the p-value of a permutation test based on X Ì.
# this sort of works but it's not a "HUGE" difference. Let's play with it more;
# increasing variability in the ctrl group helps
# Andrew - This always gives a higher p-value to the mean test with the mean of
# the ratio of the p-values at 4 and median at 2.  It took roughly an hour to run
# 1000 simulations for the p-values.  I think it has to do with the spread
# and number of realized points as the t-test gains power from increased
# sample size
tr_3 <- rnorm(10, mean = 0, sd = 1)
ctrl_3 <- rnorm(1000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] / res3$tPvalue[3]
res3$TestStats
res3$tPvalue
res3$MeansPvalue
ctrl_3 <- rnorm(1000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] / res3$tPvalue[3]
res3$TestStats
res3$tPvalue
res3$MeansPvalue
ctrl_3 <- rnorm(1000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] / res3$tPvalue[3]
res3$TestStats
res3$tPvalue
res3$MeansPvalue
ctrl_3 <- rnorm(1000, mean = 1, sd = 100)
res3 <- perm_test_mean(tr_3, ctrl_3, iters = 10000)
res3$MeansPvalue[3] / res3$tPvalue[3]
res3$TestStats
res3$tPvalue
res3$MeansPvalue
tr_4 <- c(-10:10, 500, 1000, 2000, 5000)
ctrl_4 <- rep(0:5, 5)
res4 <- perm_test_mean(tr_4, ctrl_4)
t_obs <- res4$TestStats[2]
#       t
# 1.580465
res4$MeansPvalue
#upper  lower   both
#0.0394 0.9608 0.0394
2*pt(t_obs, df = length(tr_4) + length(ctrl_4) -2, lower.tail=F)
#t
#0.1199507
### Problem 2: Construct a hypothetical dataset
# (with at least 3 data points in treatment and at least 3 in control)
# for which the p-value of a permutation test based on X Ì is smaller
# than the p-value of a permutation test based on t.
tr_2 <- rnorm(5, mean = 0, sd = 20)
# [1]  10.9933979 -16.8320749   0.6599587  10.4829942 -34.5520822
ctrl_2 <- rnorm(100, mean = 0, sd = 1)
res2 <- perm_test_mean(tr_2, ctrl_2)
res2$MeansPvalue
#upper lower  both
#0.95  0.05  0.05
#
res2$tPvalue
#upper lower  both
#0.861 0.139 0.559
res2$TestStats
#diff_means          t
#-5.7512729 -0.6559599
rm(ctrl)
rm(tr)
rm(t_obs)
save.image("D:/coursework/stat240/hw3/data.RData")
res3$TestStats
res3$tPvalue
res3$MeansPvalue
res3$MeansPvalue[3] / res3$tPvalue[3]
tr_3
mean(tr_3)
mean(ctrl_3)
?rnorm
?pstud
?pt
pt(2.00, df=1008)
