rbinom(1,1,.95)
rbinom(1,1,.95)
rbinom(1,1,.95)
rbinom(1,1,.95)
rbinom(1,1,.95)
rbinom(1,1,.95)
replacegrade(x=c(4,4,4))
replacegrade(x=c(5,5,5))
replacegrade(x=c(5,5,5))
replacegrade(x=c(5,5,5))
replacegrade(x=c(5,5,5))
replacegrade(x=c(5,5,5))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(5,5,5))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
length(c(4,4,4))
glug <- c(4,4,4)
x[1] >= 4
glug[1] >= 4
glug[2] >= 4
glug[3] >= 4
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else {
grades[i] <- rbinom(1, 1, p[i])
}
}
return(grades)
}
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else {
grades[i] <- rbinom(1, 1, p[i])
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else {
grades[i] <- rbinom(1, 1, p[i])
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else {
grades[i] <- rbinom(1, 1, p[i])
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else {
grades[i] <- rbinom(1, 1, p[i])
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else {
grades[i] <- rbinom(1, 1, p[i])
}
}
return(grades)
}
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(4,4,4))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade(x=c(3,3,3))
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, p[i])
} else {
grades[i] <- rbinom(1, 1, .9 * p[i])
}
}
return(grades)
}
replacegrade(x=c(3,3,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade(x=c(1,2,3))
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i]>=4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, p[i])
} else {
grades[i] <- rbinom(1, 1, .95 * p[i])
}
}
return(grades)
}
length(p)
nrows(foo)
nrow(foo)
apply(foo, 2, replacegrade)
apply(foo, 2, replacegrade())
apply(foo, 2, replacegrade
apply(foo, 2, replacegrade)
apply(foo, 2, replacegrade)
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i] == NA) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else (x[i] %in% c(1,2) {
grades[i] <- rbinom(1, 1, .90 * p[i])
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i] == NA) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else (x[i] %in% c(1,2) {
grades[i] <- rbinom(1, 1, .90 * p[i])
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i] == NA) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .90 * p[i])
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (x[i] == NA) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else {
grades[i] <- rbinom(1, 1, .90 * p[i])
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
foo[,1]
foo[,1][1]
foo[,1][15]
foo[,1][15] == NA
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95)
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else {
grades[i] <- rbinom(1, 1, .90 * p[i])
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
foo
rm(bar)
rm(glug)
rm(i)
rm(means)
rm(p)
rm(variances)
rm(replacegrade)
write.xlsx(foo, "D:/coursework/stat240/final_project/puff.xlsx")
library(xlsx)
install.packages('xlsx')
library(xlsx)
library(xlsx)
install.packages('rJava')
library(xlsx)
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
mean(p_)
mean(p)
foo <- read.csv("Book1.csv", header = FALSE, sep = ",", quote = "\"",
dec = ".", fill = TRUE, comment.char = "")
library(dplyr)
foo<-data.frame(foo)
foo[foo=="ABSENT"] <- NA
foo <- sapply(foo, as.numeric)
variances <- apply(foo, 1, var, na.rm=TRUE)
means <- rowMeans(foo, na.rm=TRUE)
p<-means/max(means)
mean(p)
min(p)
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, max(.95, .95 * p[i]))
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .90 * p[i])
} else if (x[i] %in% c(1,2) {
grades[i] <- rbinom(1, 1, .75 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, max(.95, .95 * p[i]))
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .90 * p[i])
} else if (x[i] %in% c(1,2) {
grades[i] <- rbinom(1, 1, .75 * p[i])
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, max(.95, .95 * p[i]))
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .90 * p[i])
} else if (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .75 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .85 * p[i])
} else if (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .70 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
foo <- read.csv("Book1.csv", header = FALSE, sep = ",", quote = "\"",
dec = ".", fill = TRUE, comment.char = "")
library(dplyr)
foo<-data.frame(foo)
foo[foo=="ABSENT"] <- NA
foo <- sapply(foo, as.numeric)
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
foo <- read.csv("Book1.csv", header = FALSE, sep = ",", quote = "\"",
dec = ".", fill = TRUE, comment.char = "")
library(dplyr)
foo<-data.frame(foo)
foo[foo=="ABSENT"] <- NA
foo <- sapply(foo, as.numeric)
variances <- apply(foo, 1, var, na.rm=TRUE)
means <- rowMeans(foo, na.rm=TRUE)
p<-means/max(means)
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .85 * p[i])
} else if (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .75 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
foo <- read.csv("Book1.csv", header = FALSE, sep = ",", quote = "\"",
dec = ".", fill = TRUE, comment.char = "")
library(dplyr)
foo<-data.frame(foo)
foo[foo=="ABSENT"] <- NA
foo <- sapply(foo, as.numeric)
variances <- apply(foo, 1, var, na.rm=TRUE)
means <- rowMeans(foo, na.rm=TRUE)
p<-means/max(means)
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .85 * p[i])
} else if (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .75 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
foo <- read.csv("Book1.csv", header = FALSE, sep = ",", quote = "\"",
dec = ".", fill = TRUE, comment.char = "")
library(dplyr)
foo<-data.frame(foo)
foo[foo=="ABSENT"] <- NA
foo <- sapply(foo, as.numeric)
variances <- apply(foo, 1, var, na.rm=TRUE)
means <- rowMeans(foo, na.rm=TRUE)
p<-means/max(means)
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .90 * p[i])
} else if (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .65 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
foo <- read.csv("Book1.csv", header = FALSE, sep = ",", quote = "\"",
dec = ".", fill = TRUE, comment.char = "")
library(dplyr)
foo<-data.frame(foo)
foo[foo=="ABSENT"] <- NA
foo <- sapply(foo, as.numeric)
variances <- apply(foo, 1, var, na.rm=TRUE)
means <- rowMeans(foo, na.rm=TRUE)
p<-means/max(means)
replacegrade <- function(x) {
grades <- rep(0, length(x))
for (i in 1:length(x)){
if (is.na(x[i])) {
grades[i] <- rbinom(1, 1, p[i])
} else if (x[i] >= 4) {
grades[i] <- rbinom(1, 1, .95 * p[i])
} else if (x[i] == 3) {
grades[i] <- rbinom(1, 1, .90 * p[i])
} else if (x[i] %in% c(1,2)) {
grades[i] <- rbinom(1, 1, .75 * p[i])
} else {
if (p[i] >= 3.5) {
grades[i] <- rbinom(1, 1, .8 * p[i])
} else {
grades[i] <- 0
}
}
}
return(grades)
}
for (i in 1:33){
foo[,i] <- replacegrade(foo[,i])
}
write.csv(foo, "D:/coursework/stat240/final_project/puff.csv")
